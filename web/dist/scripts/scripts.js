function alertMessage(e,t){t=t||"error";var o={warning:{priority:"warning",title:"Warning",timeout:5e3},success:{priority:"success",title:"Success",timeout:3e3},error:{priority:"danger",title:"Error",timeout:5e3},info:{priority:"info",title:"Info",timeout:5e3}};$.toaster({priority:o[t].priority,title:o[t].title,message:e,settings:{timeout:o[t].timeout}})}var brand="Walking Penguins",hosts={"localhost:8080":"local","localhost:3000":"local","staging.walkingpenguins.com":"staging","walkingpenguins.com":"production","walkingpenguins.com":"roadhouse"},server_uris={local:"localhost:3000",staging:"staging.walkingpenguins.com",production:"walkingpenguins.com",roadhouse:"walkingpenguins.com"},current_environment=!1,cert="cert/public.key.pem",app_server="";hosts.hasOwnProperty(window.location.host)&&(current_environment=hosts[window.location.host]),app_server="//"+server_uris[current_environment];var app=angular.module("app",["ui.router","snap","ngAnimate","cgBusy","ngCookies","appServices","ngSanitize","ngMap"]);app.server=app_server,app.value("cgBusyDefaults",{message:"loagind..."}),app.factory("httpInterceptor",["$q","$location","$rootScope","$cookieStore",function(e,t,o,s){"use strict";return{request:function(e){return e.headers=e.headers||{},e},responseError:function(s){return 400===s.status?t.path("/400"):401===s.status?(o.clearVars(),t.path("/")):404===s.status?t.path("/404"):500===s.status&&t.path("/500"),e.reject(s)}}}]),app.config(["$stateProvider","$urlRouterProvider","$httpProvider",function(e,t,o){"use strict";o.defaults.useXDomain=!0,o.defaults.withCredentials=!0,delete o.defaults.headers.common["X-Requested-With"],o.interceptors.push("httpInterceptor"),t.when("/dashboard","/dashboard/overview"),t.otherwise("/home"),e.state("base",{"abstract":!0,url:"",templateUrl:"views/base.html"}).state("base_login",{"abstract":!0,url:"",templateUrl:"views/base_login.html"}).state("baseHome",{"abstract":!0,url:"",templateUrl:"views/baseHome.html"}).state("login",{url:"/login",parent:"base",templateUrl:"views/login.html",controller:"loginController"}).state("signin",{url:"/signin",parent:"baseHome",templateUrl:"views/signin.html",controller:"loginController"}).state("signup",{url:"/signup",parent:"baseHome",templateUrl:"views/signup.html",controller:"signupController"}).state("home",{url:"/home",parent:"baseHome",templateUrl:"views/home.html",controller:"loginController"}).state("feed",{url:"/feed",parent:"base_login",templateUrl:"views/feed.html",controller:"homeController"}).state("dashboard",{url:"/dashboard",parent:"base",templateUrl:"views/dashboard.html",controller:"DashboardCtrl"}).state("overview",{url:"/overview",parent:"dashboard",templateUrl:"views/dashboard/overview.html"}).state("reports",{url:"/reports",parent:"dashboard",templateUrl:"views/dashboard/reports.html"})}]),app.run(["$q","$rootScope","$location","$cookieStore","$window","$document","Default","Verify","User","Logout",function(e,t,o,s,n,r,i,a,l,u){"use strict";t.Brand=brand,t.init=function(){i.init({},{},function(e){t.config=e;var o=t.config;console.log(o.oauth,o.common,"rootScope.config")});$.getJSON("./script/languages.json",function(e){console.log("success"),console.log(e,"languages")}).done(function(){console.log("second success")}).fail(function(){console.log("error")}).always(function(){console.log("complete")})},t.bindingVars=function(e){try{return t.logged_in=s.get("logged_in"),t.roles=s.get("roles"),t.user=s.get("user"),e(null)}catch(n){t.clearVars(function(){return o.path("/home")})}},t.clearVars=function(e){s.put("penguin_token",""),s.put("logged_in",!1),s.put("roles",[]),s.put("user",""),t.bindingVars(e)},t.bindingVars(t.init),t.verifyCookie=function(e){a.verify({},{},function(o){return o.data&&o.is_correct&&(s.put("penguin_token",o.data.token),s.put("roles",o.roles||[]),s.put("user",o.data||{}),s.put("logged_in",!0)),t.bindingVars(e)},function(t){return e(t)})},t.checkAuthen=function(e){return t.logged_in?e(null,!0):(t.logout(),e(null,!1))},t.logout=function(){u.logout({},{token:s.get("penguin_token")},function(e){t.clearVars(function(){return o.path("/home")})},function(e){})},t.goSignin=function(){o.path("/signin")},t.goSignup=function(){o.path("/signup")},t.goHome=function(){o.path("/homw")},t.loginRedirect=function(){s.get("logged_in")?o.path("/feed"):t.logout()}}]),app.filter("message",function(){return function(e){return e?'<div class="'+e.type+'">'+e.message+"</div>":""}}),app.filter("hot",function(){return function(e){return e?'<p class="font-effect-fire-animation">'+e+"</p>":""}}),app.directive("test",function(){return{link:function(e,t,o){t.bind("click",function(){t.html("You clicked me!")}),t.bind("mouseenter",function(){t.css("background-color","yellow")}),t.bind("mouseleave",function(){t.css("background-color","white")})}}}),app.directive("myNavscroll",["$window",function(e){return function(t,o,s){angular.element(e).bind("scroll",function(){console.log(this.pageTOffset,"test"),t.scrollPosition||(t.scrollPosition=0),this.pageYOffset>t.scrollPosition?t.boolChangeClass=!0:t.boolChangeClass=!1,t.scrollPosition=this.pageYOffset,t.$apply()})}}]),app.controller("loginController",["$scope","$location","$cookieStore","Login",function(e,t,o,s){"use strict";return e.user={},e.user.username="user@mail.com",e.user.password="password",e.logged_in?void e.loginRedirect():void(e.submit=function(){console.log(e,"scope"),s.login({},{app_id:e.config.oauth.app_id,username:e.user.username,password:e.user.password},function(t){t.code?alertMessage(t.message):(alertMessage(t.message,"success"),e.verifyCookie(e.loginRedirect))},function(e){alertMessage(e.message)})})}]),app.controller("signupController",["$scope","$location","$cookieStore","Login",function(e,t,o,s){"use strict";return e.user={},e.user.username="user@mail.com",e.user.password="password",e.logged_in?void e.loginRedirect():(e.nextStep=!1,void(e.submit=function(){console.log(e,"scope"),s.login({},{app_id:e.config.oauth.app_id,username:e.user.username,password:e.user.password},function(t){t.code?alertMessage(t.message):(alertMessage(t.message,"success"),e.verifyCookie(e.loginRedirect))},function(e){alertMessage(e.message)})}))}]),app.controller("homeController",["$scope","$location",function(e,t){"use strict";e.checkAuthen(function(e,t){});var o,s;e.$on("mapInitialized",function(e,t){s=t,o=s.markers[0],console.log(o.position.lat(),o.position.lng(),"marker")})}]),app.controller("mapController",["NgMap","$scope","$window",function(e,t,o){t.googleMapsUrl="https://maps.googleapis.com/maps/api/js?key=AIzaSyCbjRbBOAgumSEQiOLCDjU3IdGLLIL1blE",e.getMap().then(function(e){console.log(e.getCenter()),console.log("markers",e.markers),console.log("shapes",e.shapes)});var s,n;t.$on("mapInitialized",function(e,o){n=o,s=n.markers[0],0!=s.position.lat()&&0!=s.position.lng()&&(t.user.location=[s.position.lat(),s.position.lng()]),console.log(s.position.lat(),s.position.lng(),t.user,"marker")}),t.placeMarker=function(e){},t.click=function(e){n.setZoom(15),n.setCenter(s.getPosition()),console.log(s.getPosition(),"position")}}]),app.controller("userController",["NgMap","$scope","$window",function(e,t,o){t.updateLocation=function(e){User.update({id:t.user._id},{},function(e){console.log(e)},function(e){})}}]),app.controller("DashboardCtrl",["$scope","$state",function(e,t){"use strict";e.$state=t}]);var appServices=angular.module("appServices",["ngResource"]);appServices.factory("Default",["$resource",function(e){"use strict";return e(app_server+"/api/init",{},{init:{method:"GET",isArray:!1}})}]),appServices.factory("Login",["$resource",function(e){"use strict";return e(app_server+"/auth/signin",{},{login:{method:"POST",isArray:!1,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){return $.param(e)}}})}]),appServices.factory("Verify",["$resource",function(e){"use strict";return e(app_server+"/auth/verify",{},{verify:{method:"GET",isArray:!1}})}]),appServices.factory("Logout",["$resource",function(e){"use strict";return e(app_server+"/auth/signout",{},{logout:{method:"GET",isArray:!1}})}]),appServices.factory("User",["$resource",function(e){"use strict";return e(app_server+"/api/user/:user_id",{id:"@user_id"},{get:{method:"GET",isArray:!1,transformRequest:function(e){return $.param(e)}},update:{method:"PUT",isArray:!1}})}]),$(function(){}),function(){"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(e,t){for(var o=t||0,s=this.length;s>o;o+=1)if(void 0===e||null===e){if(this[o]===e)return o}else if(this[o]===e)return o;return-1})}(),function(e,t){var o={gettoaster:function(){var t=e("#"+n.toaster.id);return t.length<1&&(t=e(n.toaster.template).attr("id",n.toaster.id).css(n.toaster.css).addClass(n.toaster["class"]),n.stylesheet&&!e("link[href="+n.stylesheet+"]").length&&e("head").appendTo('<link rel="stylesheet" href="'+n.stylesheet+'">'),e(n.toaster.container).append(t)),t},notify:function(t,o,s){var r=this.gettoaster(),i=e(n.toast.template.replace("%priority%",s)).hide().css(n.toast.css).addClass(n.toast["class"]);if(e(".title",i).css(n.toast.csst).html(t),e(".message",i).css(n.toast.cssm).html(o),n.debug&&window.console&&console.log(toast),r.append(n.toast.display(i)),-1===n.donotdismiss.indexOf(s)){var a="number"==typeof n.timeout?n.timeout:"object"==typeof n.timeout&&s in n.timeout?n.timeout[s]:1500;setTimeout(function(){n.toast.remove(i,function(){i.remove()})},a)}}},s={toaster:{id:"toaster",container:"body",template:"<div></div>","class":"toaster",css:{position:"fixed",top:"10px",right:"10px",width:"300px",zIndex:5e4}},toast:{template:'<div class="alert alert-%priority% alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><span class="title"></span>: <span class="message"></span></div>',defaults:{title:"Notice",priority:"success"},css:{},cssm:{},csst:{fontWeight:"bold"},fade:"slow",display:function(e){return e.fadeIn(n.toast.fade)},remove:function(e,t){return e.animate({opacity:"0",padding:"0px",margin:"0px",height:"0px"},{duration:n.toast.fade,complete:t})}},debug:!1,timeout:1500,stylesheet:null,donotdismiss:[]},n={};e.extend(n,s),e.toaster=function(t){if("object"==typeof t)"settings"in t&&(n=e.extend(!0,n,t.settings));else{var s=Array.prototype.slice.call(arguments,0),r=["message","title","priority"];t={};for(var i=0,a=s.length;a>i;i+=1)t[r[i]]=s[i]}var l="title"in t&&"string"==typeof t.title?t.title:n.toast.defaults.title,u="message"in t?t.message:null,c="priority"in t&&"string"==typeof t.priority?t.priority:n.toast.defaults.priority;null!==u&&o.notify(l,u,c)},e.toaster.reset=function(){n={},e.extend(n,s)}}(jQuery);