function alertMessage(t,e){e=e||"error";var o={warning:{priority:"warning",title:"Warning"},success:{priority:"success",title:"Success"},error:{priority:"danger",title:"Error"},info:{priority:"info",title:"Info"}};$.toaster({priority:o[e].priority,title:o[e].title,message:t,settings:{timeout:5e3}})}var hosts={"localhost:3000":"local","staging.walkingpenguins.com":"staging","walkingpenguins.com":"production","walkingpenguins.com":"roadhouse"},server_uris={local:"localhost:3000",staging:"staging.walkingpenguins.com",production:"walkingpenguins.com",roadhouse:"walkingpenguins.com"},current_environment=!1,cert="cert/public.key.pem",app_server="";hosts.hasOwnProperty(window.location.host)&&(current_environment=hosts[window.location.host]),app_server="//"+server_uris[current_environment];var app=angular.module("app",["ui.router","snap","ngAnimate","cgBusy","ngCookies","appServices","ngSanitize"]);app.server=app_server,app.value("cgBusyDefaults",{message:"loagind..."}),app.factory("httpInterceptor",["$q","$location","$rootScope","$cookieStore",function(t,e,o,s){"use strict";return{request:function(t){return t.headers=t.headers||{},t.headers.penguin_access_token=s.get("penguin_access_token"),t},responseError:function(s){return 400===s.status?e.path("/400"):401===s.status?(o.clearVars(),e.path("/")):404===s.status?e.path("/404"):500===s.status&&e.path("/500"),t.reject(s)}}}]),app.config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,e,o){"use strict";o.defaults.useXDomain=!0,o.defaults.withCredentials=!0,delete o.defaults.headers.common["X-Requested-With"],o.interceptors.push("httpInterceptor"),e.when("/dashboard","/dashboard/overview"),e.otherwise("/home"),t.state("base",{"abstract":!0,url:"",templateUrl:"views/base.html"}).state("home",{url:"/home",parent:"base",templateUrl:"views/home.html",controller:"loginController"}).state("dashboard",{url:"/dashboard",parent:"base",templateUrl:"views/dashboard.html",controller:"DashboardCtrl"}).state("overview",{url:"/overview",parent:"dashboard",templateUrl:"views/dashboard/overview.html"}).state("reports",{url:"/reports",parent:"dashboard",templateUrl:"views/dashboard/reports.html"})}]),app.run(["$rootScope","$location","$cookieStore","$window","Default",function(t,e,o,s,r){"use strict";t.populateVars=function(){try{t.logged_in=o.get("logged_in"),t.roles=o.get("roles"),t.user=o.get("user")}catch(s){t.clearVars(),e.path("/home")}},t.clearVars=function(){o.put("penguin_auth",""),o.put("logged_in",!1),o.put("roles",[]),o.put("user",""),t.populateVars()},t.populateVars(),t.logout=function(){Logout.logout({},{username:o.get("username")},function(o){t.clearVars(),e.path("/")},function(t){})},t.encrypt=function(t){},t.decrypt=function(t){},t.init=function(){r.init({},{},function(e){t.config=e;var o=t.config;console.log(o.oauth,o.common,"rootScope.config")})},t.init(),t.loginRedirect=function(){o.get("user")?e.path("/user/"+o.get("user._id")):t.logout()}}]),app.filter("message",function(){return function(t){return t?'<div class="'+t.type+'">'+t.message+"</div>":""}}),app.filter("hot",function(){return function(t){return t?'<p class="font-effect-fire-animation">'+t+"</p>":""}}),app.directive("test",function(){return{link:function(t,e,o){e.bind("click",function(){e.html("You clicked me!")}),e.bind("mouseenter",function(){e.css("background-color","yellow")}),e.bind("mouseleave",function(){e.css("background-color","white")})}}}),app.controller("loginController",["$scope","$location","$rootScope","$cookies","Login",function(t,e,o,s,r){"use strict";return t.user={},t.user.username="user@mail.com",t.user.password="password",s.get("logged_in")?void o.loginRedirect():void(t.submit=function(){return r.login({},{app_id:o.config.oauth.app_id,username:t.user.username,password:t.user.password},function(t){t.code?alertMessage(t.message):alertMessage(t.message,"success"),console.log(s.getAll(),"cookie"),console.log(t,s,"success")},function(t){alertMessage(t.message)}),!1})}]),app.controller("DashboardCtrl",["$scope","$state",function(t,e){"use strict";t.$state=e}]);var appServices=angular.module("appServices",["ngResource"]);appServices.factory("Default",["$resource",function(t){"use strict";return t(app_server+"/api/init",{},{init:{method:"GET",isArray:!1}})}]),appServices.factory("Login",["$resource","$cookies",function(t,e){"use strict";return t(app_server+"/auth/signin",{},{login:{method:"POST",isArray:!1,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(t){return $.param(t)},params:{withCredentials:!0}}})}]),appServices.factory("Logout",["$resource",function(t){"use strict";return t(app_server+"/auth/signout",{},{logout:{method:"GET",isArray:!1}})}]),$(window).scroll(function(){$(".navbar").offset().top>50?$(".navbar-fixed-top").addClass("top-nav-collapse"):$(".navbar-fixed-top").removeClass("top-nav-collapse")}),$(function(){$("a.page-scroll").bind("click",function(t){var e=$(this);$("html, body").stop().animate({scrollTop:$(e.attr("href")).offset().top},1500,"easeInOutExpo"),t.preventDefault()})}),function(){"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(t,e){for(var o=e||0,s=this.length;s>o;o+=1)if(void 0===t||null===t){if(this[o]===t)return o}else if(this[o]===t)return o;return-1})}(),function(t,e){var o={gettoaster:function(){var e=t("#"+r.toaster.id);return e.length<1&&(e=t(r.toaster.template).attr("id",r.toaster.id).css(r.toaster.css).addClass(r.toaster["class"]),r.stylesheet&&!t("link[href="+r.stylesheet+"]").length&&t("head").appendTo('<link rel="stylesheet" href="'+r.stylesheet+'">'),t(r.toaster.container).append(e)),e},notify:function(e,o,s){var n=this.gettoaster(),a=t(r.toast.template.replace("%priority%",s)).hide().css(r.toast.css).addClass(r.toast["class"]);if(t(".title",a).css(r.toast.csst).html(e),t(".message",a).css(r.toast.cssm).html(o),r.debug&&window.console&&console.log(toast),n.append(r.toast.display(a)),-1===r.donotdismiss.indexOf(s)){var i="number"==typeof r.timeout?r.timeout:"object"==typeof r.timeout&&s in r.timeout?r.timeout[s]:1500;setTimeout(function(){r.toast.remove(a,function(){a.remove()})},i)}}},s={toaster:{id:"toaster",container:"body",template:"<div></div>","class":"toaster",css:{position:"fixed",top:"10px",right:"10px",width:"300px",zIndex:5e4}},toast:{template:'<div class="alert alert-%priority% alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><span class="title"></span>: <span class="message"></span></div>',defaults:{title:"Notice",priority:"success"},css:{},cssm:{},csst:{fontWeight:"bold"},fade:"slow",display:function(t){return t.fadeIn(r.toast.fade)},remove:function(t,e){return t.animate({opacity:"0",padding:"0px",margin:"0px",height:"0px"},{duration:r.toast.fade,complete:e})}},debug:!1,timeout:1500,stylesheet:null,donotdismiss:[]},r={};t.extend(r,s),t.toaster=function(e){if("object"==typeof e)"settings"in e&&(r=t.extend(!0,r,e.settings));else{var s=Array.prototype.slice.call(arguments,0),n=["message","title","priority"];e={};for(var a=0,i=s.length;i>a;a+=1)e[n[a]]=s[a]}var l="title"in e&&"string"==typeof e.title?e.title:r.toast.defaults.title,c="message"in e?e.message:null,u="priority"in e&&"string"==typeof e.priority?e.priority:r.toast.defaults.priority;null!==c&&o.notify(l,c,u)},t.toaster.reset=function(){r={},t.extend(r,s)}}(jQuery);
